<!DOCTYPE html>
<html lang="ja">

<head>
    <title>音楽</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap v5.3.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Import my stylesheet -->
    <link href="../../stylesheet/myStyle.css" type="text/css" rel="stylesheet">
    <link rel="icon" href="../../image/favicon.ico">
    <!-- OGP -->
	<meta property="og:type" content="article" />
	<meta property="og:title" content="音楽 - 悠久肆方体" />
	<meta property="og:description" content="作曲は楽しい" />
	<meta property="og:url" content="https://tktb-tess.github.io" />
	<meta property="og:site_name" content="悠久肆方体" />
	<meta property="og:image" content="https://tktb-tess.github.io/tktb-source/image/link-card.jpg" />
	<!-- Twitter card -->
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@triethylamineq" />
</head>

<body>
    <div class="container border-start border-end">
        <h2 class="my-4 p-0 section-title text-center">音楽</h2>
        
        <h4 class="text-center">〜音楽を作ると、たのしい〜</h4>
        <p class="ms-3"><a class="link-deep-blue" href="../../">← 戻る</a></p>
        <h4 class="ms-1">ライセンス</h4>
        <p class="ms-3" xmlns:cc="http://creativecommons.org/ns#">
            以下の作品は、個別の記述が無い限り、
            <a class="link-deep-blue ext-link" href="https://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">
                CC BY 4.0
                <img style="height:1rem!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt="CC">
                <img style="height:1rem!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt="BY">
            </a>
            ライセンスの下に提供されます。
        </p>
        <hr>
        <div class="card mx-3 mb-2 shadow-sm">
            <div class="card-body">
                <h4 class="card-title">Tessyrrhaqt - Welcome</h4>
                <p class="ms-1 card-text">軽く作ったPsytranceもどきのBGM。</p>
            </div>
            <audio src="https://tktb-tess.github.io/tktb-source/audio/welcome.m4a" id="wlcm" preload="metadata"></audio>
            <div class="card-body">
                <button role="button" class="btn-audio-controls" id="wlcm-play" onclick="musicPlayPause('wlcm')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                        <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/>
                    </svg>
                </button>
                <button role="button" class="btn-audio-controls" id="wlcm-stop" onclick="musicStop('wlcm')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                        <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5z"/>
                    </svg>
                </button>
                <button role="button" class="btn-audio-controls" id="wlcm-loop" onclick="toggleLoop('wlcm')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                        <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
                        <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
                    </svg>
                </button>
                <span id="wlcm-time" class="card-text">-:-- / -:--</span>
            </div>
            
            
            
        </div>
        <div class="card mx-3 mb-2 shadow-sm">
            <div class="card-body">
                <h4 class="card-title">Tessyrrhaqt - Celeste (short ver.)</h4>
                <p class="ms-1 card-text">YouTubeのエンディングで使いそうな爽快系の曲。long ver. はまだない。</p>
            </div>
            <audio src="https://tktb-tess.github.io/tktb-source/audio/celeste.m4a" id="celes" preload="metadata"></audio>
            <div class="card-body">
                <button role="button" class="btn-audio-controls" id="celes-play" onclick="musicPlayPause('celes')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                        <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/>
                    </svg>
                </button>
                <button role="button" class="btn-audio-controls" id="celes-stop" onclick="musicStop('celes')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                        <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5z"/>
                    </svg>
                </button>
                <button role="button" class="btn-audio-controls" id="celes-loop" onclick="toggleLoop('celes')">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                        <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
                        <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
                    </svg>
                </button>
                <span id="celes-time" class="card-text">-:-- / -:--</span>
            </div>
        </div>
        
    </div>

    <!-- topに戻るボタン -->
	<div id="page-top-button">
		<button class="" role="button">
			<div id="page-top-arrow"></div>
		</button>
	</div>

    <!-- Bootstrap v5.3.3 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="../../js/pagetopbutton.js"></script>

    <script>
        const audioList = document.getElementsByTagName('audio');
        const playBtnSvg = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\"><path d=\"m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z\"/></svg>";
        const pauseBtnSvg = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\"><path d=\"M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z\"/></svg>";
        let currentPlayAudio = null;
        
        for (let i = 0; i < audioList.length; i++) {
            audioList[i].addEventListener('timeupdate', function() {
                const musicID = this.id;
                const timeE = document.getElementById(musicID + '-time');
                const dur = toTime(document.getElementById(musicID).duration);
                timeE.innerHTML = toTime(this.currentTime) + ' / ' + dur;
                // console.log('timeupdate listener fired, ' + this.id);
            }, false);
            audioList[i].addEventListener('ended', function() { // 最後まで再生された場合の処理
                const musicID = this.id;
                const playBtn = document.getElementById(musicID + '-play');
                const playTime = document.getElementById(musicID + '-time');
                playTime.innerHTML = '0:00 / ' + toTime(this.duration);
                currentPlayAudio = null;
                playBtn.innerHTML = playBtnSvg;
                // console.log('ended listener fired, ' + this.id);
            }, false);
        }
        
        const musicPlayPause = (musicID) => {
            const playBtn = document.getElementById(musicID + '-play');
            const playTime = document.getElementById(musicID + '-time');
            const mDuration = toTime(document.getElementById(musicID).duration);

            if (currentPlayAudio === null) { // 何も再生されていない場合
                currentPlayAudio = audioList.namedItem(musicID);
                currentPlayAudio.play();
                playBtn.innerHTML = pauseBtnSvg;

            } else if (currentPlayAudio.id !== musicID) { // 他の曲が再生されている場合
                const prevPlayBtn = document.getElementById(currentPlayAudio.id + '-play');
                const prevPlayTime = document.getElementById(currentPlayAudio.id + '-time');

                // 前の曲を止める
                currentPlayAudio.pause();
                currentPlayAudio.currentTime = 0;
                prevPlayBtn.innerHTML = playBtnSvg;

                // 再生処理
                currentPlayAudio = document.getElementById(musicID);
                currentPlayAudio.play();
                playBtn.innerHTML = pauseBtnSvg;

                // console.log('new song started');

            } else if (currentPlayAudio.paused) { // 再開
                currentPlayAudio.play();
                playBtn.innerHTML = pauseBtnSvg;

            } else if (!currentPlayAudio.paused) { // 一時停止
                currentPlayAudio.pause();
                playBtn.innerHTML = playBtnSvg;

            } else {
                console.log('unidentified error');
            }
        }

        const musicStop = (musicID) => { // 停止
            const playBtn = document.getElementById(musicID + '-play');
            const playTime = document.getElementById(musicID + '-time');

            if (currentPlayAudio) {
                if (currentPlayAudio.id === musicID) {
                    currentPlayAudio.pause();
                    currentPlayAudio.currentTime = 0;
                    currentPlayAudio = null;
                    playBtn.innerHTML = playBtnSvg;
                    // console.log('music stopped');
                }
            }
        }

        const toggleLoop = (musicID) => { // ループ再生のトグル
            const loopBtn = document.getElementById(musicID + '-loop');
            loopBtn.classList.toggle('active');
            document.getElementById(musicID).loop = !document.getElementById(musicID).loop;
        }
        
        const toTime = (time) => { // 秒の小数表示を時刻表示に変換
            const sec = Math.trunc(time) % 60;
            const min = Math.trunc(time / 60);
            const sec_str = (sec < 10) ? '0' + sec.toString() : sec.toString();
            return min.toString() + ':' + sec_str;
        }
        
    </script>


</body>